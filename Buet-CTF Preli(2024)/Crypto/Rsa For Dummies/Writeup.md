# Rsa For Dummies
## Points - 70
## Objective:
The goal is to decrypt an RSA-encrypted message using **Wiener's Attack**. This attack works when the RSA private key `d` is small compared to `n`, specifically when `d < n^0.25`. Given the values of `e`, `n`, and `c` (in hexadecimal), we use the attack to recover `d` and decrypt the ciphertext.

## Approach:

1. **Wiener's Attack** is based on the observation that when `d` is small, the fraction `e/n` has a simple continued fraction expansion, and one of the convergents of this continued fraction gives the correct value of `d`.
   
2. **Step-by-Step Approach**:
    - First, we generate the continued fraction expansion of `e/n`.
    - We then compute the convergents of this continued fraction.
    - For each convergent `(k, d)`, we check if it satisfies the RSA equation `(e * d - 1) % k == 0`.
    - If this is true, we compute the value of `phi(n)` as `(e * d - 1) // k`.
    - We then solve the quadratic equation derived from `phi(n)` to check if it yields valid factors of `n`.
    - If the discriminant is a perfect square, we have found a valid `d` and can decrypt the message.

3. **Decryption**:
    - Once we have `d`, we use the RSA decryption formula `m = c^d % n` to decrypt the ciphertext.
    - The decrypted message is converted from bytes to a readable string format.

we will not hardcode the code. Lets just sit back and let do `Oweiner` Library to do the job

```Python
import owiener
from Crypto.Util.number import long_to_bytes
ct = 15992705724089064444120193146889712084437595934713568135282969350510849933920626015322474190620035040445065249985765253622975199802810700812272572810008216120514856205658683729410860637142545320284596805191642294950093980161541618167303571397067308574096030957532768552576855057335595799372149867813130402869883159687278015357066721069496681991813256408911264597190678513165440826541874385457399958568116720382993812989529003199416870444071610828146432837826364883236881976633562543124184977378867506469068113588455188060512267554841339890539470043097603306051086746223825971034634647938119634155472281495035628566897
n = 23227936232164029970861530739720544352520778735720935207420890174882376827412333933655430773050125063223105279952252646645688444555172775195507551985310194640889895104324456018646125832601779089679701590827611356256710170383531637631760073511661517218646111235975710250411153371873272173049382954008380631003571757611911325340279048021205846952124110222781267454105464350339248989321072629154823927323728421795677221358366526628599478273943164942256137893977888423049286717606728728461966516489140526086143065447489407230653860906178756455507605812427072930666690693793955049309035462672187747738694300544235304694597
e = 9505514526301829717263294425081225773147921488640061749877355257123379885239952101235121118760733225471441278054683129219098179918265288144199680250758835921246817655530970968513158816149975795977249999054829923122104061701585665149205727174280741248954476814722256551823220236433595834106467648179959174974255279776047949321307731418439212077207656734729528117649895238614852179887318782208155144428392348643169772073483319438274649293746065634561599304250937530240744889939318968632641223770595969621799372740839777439173428644107328655908247290982060044254056679496622834448418895866065411065368238894486420418797

d = owiener.attack(e, n)

if d is None:
    print("Failed")
else:
    print("Hacked d={}".format(d))
    print("Decrypted: {}".format(long_to_bytes(pow(ct, d, n))))
```

#### Flag - BUETCTF{rs4_rs4_wh3r3_4rt_th0u}